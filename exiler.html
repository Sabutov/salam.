<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <title>Futbol N…ôtic…ôl…ôri</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root { --primary-color: #00796b; }
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #e0f7fa, #e0f2f1);
      color: #333;
      font-size: 1rem;
    }
    header {
      background: var(--primary-color);
      color: white;
      padding: 20px;
      text-align: center;
      position: relative;
    }
    .menu-toggle {
      position: absolute;
      left: 20px;
      top: 20px;
      background: none;
      border: none;
      color: white;
      font-size: 26px;
      cursor: pointer;
      z-index: 1001;
    }
    .side-menu {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background: #004d40;
      padding-top: 60px;
      transition: 0.3s;
      z-index: 1000;
    }
    .side-menu a {
      display: block;
      padding: 15px 25px;
      color: white;
      text-decoration: none;
      font-size: 18px;
    }
    .side-menu a:hover {
      background-color: #00695c;
    }
    .side-menu.open {
      left: 0;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px;
      justify-content: center;
    }
    input, select, button {
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #bbb;
      font-size: 1em;
      min-width: 150px;
    }
    .match {
      background: #fff;
      padding: 20px;
      margin: 10px auto;
      max-width: 800px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      cursor: pointer;
    }
    .match:hover { background-color: #f1f1f1; }
    .teams {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .team-logo {
      width: 32px;
      height: 32px;
    }
    .stats {
      margin-top: 10px;
      font-size: 0.95rem;
      color: #444;
      display: none;
    }
    @media(max-width: 768px) {
      html { font-size: 16px; }
      .controls { flex-direction: column; align-items: stretch; }
      .teams { flex-direction: column; }
    }
  </style>
</head>
<body>

  <header>
    <button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>
    <h1>Futbol Oyunlarƒ±</h1>
  </header>

  <div class="side-menu" id="sideMenu">
    <a href="https://mccleaurg-glionts-twaency.yolasite.com/" target="_blank">üè† Yerli Futbol X…ôb…ôrl…ôri</a>
    <a href="https://mccleaurg-glionts-twaency.yolasite.com/xarici-futbol-x%C9%99b%C9%99rl%C9%99ri/" target="_blank">üåç Xarici Futbol X…ôb…ôrl…ôri</a>
  </div>

  <div class="controls">
    <input type="date" id="dateInput">
    <input type="text" id="searchInput" placeholder="Komanda axtar...">
    <select id="countryFilter"><option value="">üåç B√ºt√ºn √∂lk…ôl…ôr</option></select>
    <select id="leagueFilter"><option value="">üèÜ B√ºt√ºn turnirl…ôr</option></select>
    <button onclick="fetchMatches()">üîÑ Yenil…ô</button>
  </div>

  <h2 style="text-align:center;">üìÖ Bug√ºnk√º Oyunlar</h2>
  <div id="past-matches">Y√ºkl…ônir...</div>
  <div id="upcoming-matches"></div>

  <script>
    const dateInput = document.getElementById('dateInput');
    const searchInput = document.getElementById('searchInput');
    const countryFilter = document.getElementById('countryFilter');
    const leagueFilter = document.getElementById('leagueFilter');
    const menu = document.getElementById('sideMenu');

    dateInput.value = new Date().toISOString().split('T')[0];

    function toggleMenu() {
      menu.classList.toggle('open');
    }

    async function fetchMatches() {
      const date = dateInput.value;
      const search = searchInput.value.toLowerCase();
      const selectedCountry = countryFilter.value;
      const selectedLeague = leagueFilter.value;

      try {
        const res = await fetch(`https://api.sofascore.com/api/v1/sport/football/scheduled-events/${date}`);
        const data = await res.json();
        const events = data.events;

        const countries = [...new Set(events.map(e => e.tournament.category.country.name))];
        const leagues = [...new Set(events.map(e => e.tournament.name))];
        countryFilter.innerHTML = '<option value="">üåç B√ºt√ºn √∂lk…ôl…ôr</option>' + countries.map(c => `<option value="${c}">${c}</option>`).join('');
        leagueFilter.innerHTML = '<option value="">üèÜ B√ºt√ºn turnirl…ôr</option>' + leagues.map(l => `<option value="${l}">${l}</option>`).join('');

        const filtered = events.filter(e =>
          (e.homeTeam.name.toLowerCase().includes(search) || e.awayTeam.name.toLowerCase().includes(search)) &&
          (selectedCountry === '' || e.tournament.category.country.name === selectedCountry) &&
          (selectedLeague === '' || e.tournament.name === selectedLeague)
        );

        filtered.sort((a, b) => a.startTimestamp - b.startTimestamp);
        displayGroupedMatches(filtered);
      } catch (err) {
        document.getElementById('past-matches').innerText = '‚ùå X…ôta ba≈ü verdi.';
        document.getElementById('upcoming-matches').innerText = '';
      }
    }

    function displayGroupedMatches(matches) {
      const containerPast = document.getElementById('past-matches');
      const containerUpcoming = document.getElementById('upcoming-matches');
      containerPast.innerHTML = '';
      containerUpcoming.innerHTML = '';

      const now = Math.floor(Date.now() / 1000);
      const groups = {};

      for (const match of matches) {
        const id = match.tournament.id;
        if (!groups[id]) groups[id] = { tournament: match.tournament, matches: [] };
        groups[id].matches.push(match);
      }

      for (const groupId in groups) {
        const group = groups[groupId];
        const groupBox = document.createElement('div');
        const logoUrl = `https://api.sofascore.app/api/v1/unique-tournament/${group.tournament.uniqueTournament.id}/image`;

        groupBox.innerHTML = `
          <h3 style="display:flex; align-items:center; gap:10px; margin-top:30px;">
            <img src="${logoUrl}" alt="logo" style="width:32px;height:32px;"> ${group.tournament.name}
          </h3>
        `;

        for (const match of group.matches) {
          const isLive = match.status.type === "inprogress";
          const timestamp = match.startTimestamp;
          const logo1 = `https://api.sofascore.app/api/v1/team/${match.homeTeam.id}/image`;
          const logo2 = `https://api.sofascore.app/api/v1/team/${match.awayTeam.id}/image`;
          const goals = (match.goals || []).map(g => `‚öΩ ${g.player.name} (${g.home ? match.homeTeam.name : match.awayTeam.name})`).join('<br>');
          const minute = isLive && match.time ? `${match.time.current ? match.time.current : 'N/A'}‚Äô` : '';
          let statusLabel = isLive ? `<span style="color:green; font-weight:bold;">üü¢ Canlƒ± ${minute}</span>` : '';
          if (match.status.type === "pause") statusLabel = `<span style="color:orange;">‚è∏Ô∏è Fasil…ô</span>`;
          if (match.status.type === "finished") statusLabel = `<span style="color:red;">üîö Bitdi</span>`;

          const div = document.createElement('div');
          div.className = 'match';
          div.innerHTML = `
            <div class="teams">
              <img class="team-logo" src="${logo1}" alt="logo">
              <strong>${match.homeTeam.name}</strong>
              <span>${match.homeScore.current ?? ''} - ${match.awayScore.current ?? ''}</span>
              <strong>${match.awayTeam.name}</strong>
              <img class="team-logo" src="${logo2}" alt="logo">
            </div>
            <div>
              ${statusLabel}<br>
              üóìÔ∏è ${new Date(timestamp * 1000).toLocaleString()}<br>
              üó∫Ô∏è ${match.tournament.category.country.name}
              <div class="stats">${goals ? `<br><br><strong>Qollar:</strong><br>${goals}` : 'Statistika m√∂vcud deyil.'}</div>
            </div>
          `;
          div.addEventListener("click", () => {
            const stats = div.querySelector(".stats");
            stats.style.display = stats.style.display === "block" ? "none" : "block";
          });

          groupBox.appendChild(div);
        }

        const earliest = group.matches[0].startTimestamp;
        if (earliest < now) containerPast.appendChild(groupBox);
        else containerUpcoming.appendChild(groupBox);
      }
    }

    fetchMatches();
    setInterval(fetchMatches, 60000);
  </script>
</body>
</html>
