<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Canlƒ± Futbol N…ôtic…ôl…ôri - ∆èsas Liqalar</title>
  <style>
    /* √úmumi */
    body {
      background-color: #111;
      color: #eee;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 10px;
      user-select: none;
    }
    h1 {
      text-align: center;
      color: #00ffc3;
      margin-top: 15px;
    }

    /* Hamburger Menyu */
    #menuToggle {
      position: fixed;
      top: 15px;
      left: 15px;
      z-index: 9999;
      display: block;
      width: 30px;
      height: 25px;
      cursor: pointer;
    }
    #menuToggle span {
      display: block;
      height: 4px;
      margin-bottom: 5px;
      background: #00ffc3;
      border-radius: 2px;
      transition: 0.3s ease;
    }
    #menuToggle input {
      display: none;
    }
    nav {
      position: fixed;
      background: #222;
      height: 100%;
      width: 250px;
      top: 0;
      left: -260px;
      padding-top: 60px;
      transition: 0.3s ease;
      z-index: 9998;
    }
    #menuToggle input:checked ~ nav {
      left: 0;
    }
    nav a {
      display: block;
      color: #00ffc3;
      text-decoration: none;
      padding: 12px 25px;
      font-weight: bold;
      font-size: 18px;
      border-bottom: 1px solid #333;
    }
    nav a:hover {
      background: #00ffc3;
      color: #111;
    }
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      background: rgba(0,0,0,0.5);
      width: 100%;
      height: 100%;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 9997;
    }
    #menuToggle input:checked ~ #overlay {
      opacity: 1;
      pointer-events: auto;
    }

    /* Turnir v…ô mat√ßlar */
    .tournament {
      margin-top: 50px;
    }
    .tournament h2 {
      border-bottom: 1px solid #444;
      padding-bottom: 5px;
      margin-bottom: 10px;
      color: #ffdb58;
    }
    .match {
      background: #1a1a1a;
      margin-bottom: 15px;
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      user-select: none;
    }
    .teams {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 16px;
    }
    .team-logo {
      width: 30px;
      height: 30px;
      object-fit: contain;
      vertical-align: middle;
      margin-right: 8px;
    }
    .score {
      font-size: 20px;
      text-align: center;
      margin: 10px 0;
      font-weight: bold;
      user-select: text;
    }
    .status {
      text-align: right;
      font-size: 14px;
      color: #aaa;
      user-select: text;
    }
    .goal-scorers, .stat {
      font-size: 13px;
      margin-top: 5px;
      color: #ccc;
      display: none;
      user-select: text;
    }
    .live-tag {
      background: red;
      color: white;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 4px;
      margin-left: 8px;
      user-select: none;
    }
    .section-title {
      margin-top: 40px;
      color: #00ffc3;
      font-size: 22px;
      border-bottom: 1px solid #333;
    }
  </style>
</head>
<body>

  <h1>‚öΩ Canlƒ± Futbol N…ôtic…ôl…ôri</h1>

  <label id="menuToggle" for="menu-checkbox" aria-label="Menyu a√ß">
    <input type="checkbox" id="menu-checkbox" />
    <span></span>
    <span></span>
    <span></span>
  </label>

  <nav>
    <a href="https://mccleaurg-glionts-twaency.yolasite.com/" target="_blank" rel="noopener noreferrer">Yerli Futbol X…ôb…ôrl…ôri</a>
    <a href="https://www.fifa.com/news" target="_blank" rel="noopener noreferrer">Beyn…ôlxalq Futbol X…ôb…ôrl…ôri</a>
  </nav>
  <div id="overlay"></div>

  <!-- Canlƒ± Mat√ßlar - ∆èsas Liqalar -->
  <h2 class="section-title">üî• CANLI - ∆èsas Liqalar</h2>
  <div id="live-main"></div>

  <!-- Canlƒ± Mat√ßlar - Dig…ôr Liqalar -->
  <h2 class="section-title">üî• CANLI - Dig…ôr Liqalar</h2>
  <div id="live-other"></div>

  <!-- G…ôl…ôc…ôk Mat√ßlar -->
  <h2 class="section-title">üîú G…ôl…ôc…ôk Mat√ßlar</h2>
  <div id="upcoming">Y√ºkl…ônir...</div>

  <!-- Turnir C…ôdv…ôll…ôri - ∆èsas Liqalar -->
  <h2 class="section-title">üìä Turnir C…ôdv…ôll…ôri - ∆èsas Liqalar</h2>
  <div id="tables-main"></div>

  <script>
    // Men√º overlay qapama
    document.getElementById('overlay').addEventListener('click', () => {
      document.getElementById('menu-checkbox').checked = false;
    });

    // ∆èsas liqalar siyahƒ±sƒ± (Sofascore turnir adlarƒ± il…ô)
    const mainLeagues = [
      "Premier League",
      "La Liga",
      "Bundesliga",
      "Serie A",
      "Ligue 1"
    ];

    async function fetchGoalScorers(eventId) {
      try {
        const res = await fetch(`https://api.sofascore.com/api/v1/event/${eventId}/incident`);
        const data = await res.json();
        const goals = data.incidents.filter(e => e.type === "goal" && e.player);
        return goals.map(goal => `${goal.player.name} ${goal.time.minute}'`).join(", ");
      } catch {
        return "Qol vuranlar m√∂vcud deyil.";
      }
    }

    async function fetchStatistics(eventId) {
      try {
        const res = await fetch(`https://api.sofascore.com/api/v1/event/${eventId}/statistics`);
        const data = await res.json();
        const stats = data.statistics.flatMap(g => g.groups).flatMap(i => i.statisticsItems);
        const important = stats.filter(s => ['Ball possession', 'Total shots', 'Shots on target', 'Yellow cards', 'Red cards'].includes(s.name));
        return important.map(s => `${s.name}: ${s.home} - ${s.away}`).join("<br>");
      } catch {
        return "Statistika yoxdur.";
      }
    }

    // Canlƒ± mat√ßlarƒ± √ß…ôk v…ô …ôsas/dig…ôr liqalara ayƒ±r
    async function fetchLiveMatches() {
      const containerMain = document.getElementById("live-main");
      const containerOther = document.getElementById("live-other");
      containerMain.innerHTML = "Yenil…ônir...";
      containerOther.innerHTML = "Yenil…ônir...";

      try {
        const res = await fetch("https://api.sofascore.com/api/v1/sport/football/events/live");
        const data = await res.json();

        // Turnirl…ôri …ôsas v…ô dig…ôr olaraq qrupla≈üdƒ±r
        let mainTournaments = {};
        let otherTournaments = {};

        data.events.forEach(event => {
          const tname = event.tournament.name;

          // ∆èsas liqaya daxildirs…ô
          if(mainLeagues.includes(tname)) {
            if (!mainTournaments[tname]) mainTournaments[tname] = [];
            mainTournaments[tname].push(event);
          } else {
            if (!otherTournaments[tname]) otherTournaments[tname] = [];
            otherTournaments[tname].push(event);
          }
        });

        // Funksiya turnir…ô mat√ßlarƒ± …ôlav…ô etm…ôk √º√ß√ºn
        function addMatches(container, tournaments) {
          container.innerHTML = "";
          for (const [tournament, events] of Object.entries(tournaments)) {
            const tDiv = document.createElement("div");
            tDiv.className = "tournament";
            tDiv.innerHTML = `<h2>${tournament}</h2>`;

            events.forEach(e => {
              const mDiv = document.createElement("div");
              mDiv.className = "match";
              const home = e.homeTeam;
              const away = e.awayTeam;
              const score = `${e.homeScore.current ?? 0} - ${e.awayScore.current ?? 0}`;
              const minute = e.time?.minute ?? "";
              const status = e.status?.description || "";
              const isHalfTime = status.toLowerCase().includes("half") || status.toLowerCase().includes("break");
              const showStatus = isHalfTime ? "Fasil…ô" : `${status} ${minute ? '(' + minute + "‚Ä≤)" : ''}`;
              const liveTag = e.status?.type === "inprogress" ? '<span class="live-tag">CANLI</span>' : "";

              mDiv.innerHTML = `
                <div class="teams">
                  <div><img class="team-logo" src="https://api.sofascore.app/api/v1/team/${home.id}/image" alt="${home.name}"> ${home.name}</div>
                  <div><img class="team-logo" src="https://api.sofascore.app/api/v1/team/${away.id}/image" alt="${away.name}"> ${away.name}</div>
                </div>
                <div class="score">${score}</div>
                <div class="status">${showStatus} ${liveTag}</div>
                <div class="goal-scorers" id="goals-${e.id}">Qollar y√ºkl…ônir...</div>
                <div class="stat" id="stat-${e.id}">Statistika y√ºkl…ônir...</div>
              `;

              // Mat√ß klikl…ôndikd…ô statistikalarƒ± a√ßƒ±b-baƒülamaq
              mDiv.addEventListener('click', () => {
                const goalsDiv = document.getElementById(`goals-${e.id}`);
                const statDiv = document.getElementById(`stat-${e.id}`);
                if(goalsDiv.style.display === "block") {
                  goalsDiv.style.display = "none";
                  statDiv.style.display = "none";
                } else {
                  goalsDiv.style.display = "block";
                  statDiv.style.display = "block";

                  // H…ôr d…ôf…ô yenil…ô
                  fetchGoalScorers(e.id).then(text => { goalsDiv.textContent = "Qollar: " + (text || "Yoxdur"); });
                  fetchStatistics(e.id).then(html => { statDiv.innerHTML = html; });
                }
              });

              tDiv.appendChild(mDiv);
            });
            container.appendChild(tDiv);
          }
        }

        addMatches(containerMain, mainTournaments);
        addMatches(containerOther, otherTournaments);
      } catch (e) {
        console.error(e);
        containerMain.innerHTML = "Canlƒ± mat√ßlar m√∂vcud deyil.";
        containerOther.innerHTML = "";
      }
    }

    // G…ôl…ôc…ôk mat√ßlarƒ± g√∂st…ôr
    async function fetchUpcomingMatches() {
      const container = document.getElementById("upcoming");
      container.innerHTML = "Yenil…ônir...";

      try {
        const res = await fetch("https://api.sofascore.com/api/v1/sport/football/events/upcoming");
        const data = await res.json();

        // Sad…ôc…ô g…ôl…ôc…ôk 15 mat√ßƒ± g√∂st…ôr…ôk
        const matches = data.events.slice(0, 15);

        container.innerHTML = "";
        matches.forEach(e => {
          const div = document.createElement("div");
          div.className = "match";

          const home = e.homeTeam;
          const away = e.awayTeam;
          const date = new Date(e.startTimestamp * 1000);
          const timeStr = date.toLocaleString('az-AZ', {hour: '2-digit', minute: '2-digit', day: 'numeric', month: 'short'});

          div.innerHTML = `
            <div class="teams">
              <div><img class="team-logo" src="https://api.sofascore.app/api/v1/team/${home.id}/image" alt="${home.name}"> ${home.name}</div>
              <div><img class="team-logo" src="https://api.sofascore.app/api/v1/team/${away.id}/image" alt="${away.name}"> ${away.name}</div>
            </div>
            <div class="status">Ba≈ülama vaxtƒ±: ${timeStr}</div>
          `;

          container.appendChild(div);
        });
      } catch {
        container.innerHTML = "G…ôl…ôc…ôk mat√ßlar m√∂vcud deyil.";
      }
    }

    // Turnir c…ôdv…ôll…ôri (…ôsas liqalar)
    async function fetchTables() {
      const container = document.getElementById("tables-main");
      container.innerHTML = "Yenil…ônir...";

      try {
        // ∆èsas liqalar √º√ß√ºn c…ôdv…ôl sorƒüularƒ±
        // Sofascore API-d…ôn …ôl il…ô uyƒüun tournament IDs lazƒ±m olarsa d…ôyi≈üm…ôk olar
        // Burada sad…ôc…ô canlƒ± liqalar arasƒ±nda olanlarƒ± g√∂st…ôririk (dynamic)
        // M…ôs…ôl…ôn √º√ß√ºn n√ºmun…ô kimi istifad…ô edirik
        const tournamentIds = {
          "Premier League": 17,
          "La Liga": 11,
          "Bundesliga": 10,
          "Serie A": 8,
          "Ligue 1": 9
        };

        container.innerHTML = "";
        for (const [name, id] of Object.entries(tournamentIds)) {
          try {
            const res = await fetch(`https://api.sofascore.com/api/v1/league/${id}/standings`);
            const data = await res.json();
            if(!data.standings) continue;

            const div = document.createElement("div");
            div.className = "tournament";

            div.innerHTML = `<h2>${name} C…ôdv…ôli</h2>`;

            // C…ôdv…ôl yaradƒ±lmasƒ±
            const table = document.createElement("table");
            table.style.width = "100%";
            table.style.borderCollapse = "collapse";
            table.style.color = "#eee";
            table.style.marginBottom = "30px";

            // C…ôdv…ôl ba≈ülƒ±ƒüƒ±
            const thead = document.createElement("thead");
            thead.innerHTML = `
              <tr style="border-bottom: 2px solid #555;">
                <th>#</th>
                <th>Komanda</th>
                <th>O</th>
                <th>Q</th>
                <th>M</th>
                <th>U</th>
                <th>Qol</th>
                <th>Xal</th>
              </tr>`;
            table.appendChild(thead);

            const tbody = document.createElement("tbody");

            data.standings.forEach(team => {
              const tr = document.createElement("tr");
              tr.style.borderBottom = "1px solid #333";
              tr.innerHTML = `
                <td>${team.position}</td>
                <td><img src="https://api.sofascore.app/api/v1/team/${team.team.id}/image" alt="${team.team.name}" style="width:20px; vertical-align:middle; margin-right:5px;">${team.team.name}</td>
                <td>${team.matchesPlayed}</td>
                <td>${team.wins}</td>
                <td>${team.losses}</td>
                <td>${team.draws}</td>
                <td>${team.goalsFor}:${team.goalsAgainst}</td>
                <td>${team.points}</td>
              `;
              tbody.appendChild(tr);
            });

            table.appendChild(tbody);
            div.appendChild(table);
            container.appendChild(div);

          } catch (e) {
            console.warn(`C…ôdv…ôl y√ºkl…ônm…ôdi: ${name}`, e);
          }
        }
      } catch (e) {
        container.innerHTML = "Turnir c…ôdv…ôll…ôri m√∂vcud deyil.";
      }
    }

    // S…ôhif…ô y√ºkl…ôn…ônd…ô v…ô h…ôr 60 saniy…ôd…ôn bir yenil…ô
    async function refreshAll() {
      await Promise.all([
        fetchLiveMatches(),
        fetchUpcomingMatches(),
        fetchTables()
      ]);
    }

    refreshAll();
    setInterval(refreshAll, 60000); // 1 d…ôqiq…ôd…ô yenil…ô

  </script>

</body>
</html>
